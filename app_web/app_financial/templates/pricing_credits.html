{% extends "base.html" %}
{% load static %}

{% block main %}
  <p class="text-center text-muted">
    ðŸ“Œ This section is not open-source â€” it's based on a purchased theme whose HTML markup remains proprietary and cannot be shared under open-source terms.
  </p>

<script src="https://js.stripe.com/v3/"></script>
<script>
    const stripe = Stripe('{{ stripe_key }}');

function createCheckoutSession(price) {
    fetch("{% url 'create_credit_checkout_session' %}?price=" + price)
        .then(response => response.json())
        .then(data => {
            console.log(data);
            if (data.error) {
                if (data.error === "Not authenticated") {
                    window.location.href = "{% url 'login' %}";
                } else if (data.error === "Invalid amount") {
                    alert("Invalid amount");
                } else {
                    alert("Unknown error occurred: " + data.error);
                }
            } else if (data.session_id) {
                stripe.redirectToCheckout({
                    sessionId: data.session_id
                });
            } else {
                alert("Unknown error occurred.");
            }
        })
        .catch(error => {
            console.error('There was an error:', error);
        });
}

</script>
{% endblock %}